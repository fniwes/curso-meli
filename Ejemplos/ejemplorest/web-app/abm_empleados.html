<!DOCTYPE html>
<html>
<head>
	<title>ABM Empleados</title>
	<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
</head>
<body>
	<table>
		<thead>
			<tr>
				<th>Nombre</th><th>Apellido</th><th>Cumpleanos</th>
			</tr>
		</thead>
		<tbody id="empleadoList">
			<!-- Agregar aquÃ­ empleados -->
		</tbody>
	</table>

	<form id="formCreate">
		<div><label>Nombre: <input type="text" name="nombre" id="txtnombre" /></label></div>
		<div><label>Apellido: <input type="text" name="apellido" id="txtapellido" /></label></div>
		<div><label>Nacimiento: <input type="text" name="nacimiento" id="txtnacimiento" /></label></div>
		<button type="button" id="btnCrear">Crear empleado</button>
	</form>

	<script type="text/template" id="rowTemplate">
		<tr>
			<td>#nombre</td><td>#apellido</td><td>#cumpleanos</td>
		</tr>
	</script>

	<script>
		function listar() {
			$.get("/ejemplorest/empleado.json")
				.done( function(data) {
					$("#empleadoList").empty();
					$.each(data, agregarEmpleado);
				});
		}

		function agregarEmpleado(index, empleado) {
			var str = $("#rowTemplate").html();

			str = str.replace("#nombre", empleado.name);
			str = str.replace("#apellido", empleado.lastname);
			str = str.replace("#cumpleanos", empleado.birthday);

			$("#empleadoList").append(str);
		}

		$("#btnCrear").click(function() {
			var json = {
				name: $("#txtnombre").val(),
				lastname: $("#txtapellido").val(),
				birthday: $("#txtnacimiento").val(),
			}

			var promise = $.ajax("/ejemplorest/empleado.json", {
				method: "post",
				contentType: 'application/json; charset=utf-8',
				data: JSON.stringify(json)
			});

			promise.done(function(empleado) {
				agregarEmpleado(0, empleado)
			})
		});

		listar();
	</script>
</body>
</html>